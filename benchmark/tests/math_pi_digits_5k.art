digits: #()


pi_digits: @(x){
    q:1
    r:0
    t:1
    k:1
    n:3
    l:3

    loop [size digits]!=x {
        nt: n*t
        if 4*q+r-t < nt {
            append! digits n
            nr: 10*(r-nt)
            n: ((10*(3*q+r)) / t) - 10*n
            mul! q 10//: q * 10
            r: nr
        } {
            nr : (2*q+r) * l
            nn : (q*(7*k+2)+r*l) / (t*l)
            mul! q k//q : q * k
            mul! t l//t : t * l
            add! l 2//l: l + 2 //l : l + 2
            inc! k //k:k+1//inc! k// : k + 1
            n : nn
            r : nr
        }
    }
}

[pi_digits 5000]

loop digits {
    print &
}
