digits: #()


pi_digits: @(x){
    q: toMutable 1
    r:0
    t:1
    k:1
    n:3
    l:3

    loop [size digits]!=x {
        if 4*q+r-t < n*t {
            append! digits n
            nr: 10*(r-n*t)
            n: ((10*(3*q+r)) / t) - 10*n
            mul! q 10
            r: nr
        } {
            nr : (2*q+r) * l
            nn : (q*(7*k+2)+r*l) / (t*l)
            q : q * k
            t : t * l
            l : l + 2
            k : k + 1
            n : nn
            r : nr
        }
    }
}

[pi_digits 5000]

loop digits {
    print &
}
