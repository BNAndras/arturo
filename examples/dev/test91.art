millerRabin [n,g]{
  d n-1
  s 0
  loop d%2=0 {
    d d/2
    s s+1
  }
  loop $(range 1 g) {
    a $(random 2 n-4)
    x (a^d)%n
    if $(not $(or x=1 x=n-1)) {
      loop $(range 1 s-1) [r]{
        x = (x^2)%n
        if x=1 { return false }
      }
      if x!=n-1 { return false }
    }
  }
  return true
}

loop $(range 7 200 2) [a]{
  print a + " => " + $(!millerRabin a 10)
}
