
tokenize: @(s sep esc){
	escaping: 0
	loop [range 0 [size s]-1] @(i){
		chr: [chars s].[i]

		if escaping=1 {
			prints chr
			escaping: 0
		} {
			if chr=sep {
				print ""

			} {
				if chr=esc {
					escaping: 1
				} {
					prints chr
				}
			}
		}
	}
	print ""
}

str: "one^|uno||three^^^^|four^^^|^cuatro|" 
print [tokenize str "|" "^"]
